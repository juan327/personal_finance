import{a as R,b as G,c as N,d as $,e as A}from"./chunk-FSU7QG54.js";import{Ea as T,Fb as y,Gb as H,Hb as F,Ja as I,Mb as C,Nb as k,Qa as M,V as _,Wa as e,Xa as t,Ya as b,ab as P,d as B,eb as n,fb as g,gb as x,hb as D,jb as E,kb as S,lb as f,va as r}from"./chunk-L45R5B7A.js";var j=B(G());function w(c,o){c&1&&(e(0,"h2"),n(1,"Ultimos movimientos"),t())}function U(c,o){c&1&&(e(0,"tr")(1,"th"),n(2,"Categor\xEDa"),t(),e(3,"th"),n(4,"Nombre"),t(),e(5,"th"),n(6,"Monto"),t(),e(7,"th"),n(8,"Fecha"),t(),e(9,"th"),n(10,"Descripci\xF3n"),t(),e(11,"th"),n(12,"Creaci\xF3n"),t()())}function V(c,o){if(c&1&&(e(0,"tr")(1,"td"),n(2),t(),e(3,"td"),n(4),t(),e(5,"td"),n(6),t(),e(7,"td"),n(8),E(9,"date"),t(),e(10,"td"),n(11),t(),e(12,"td"),n(13),E(14,"date"),t()()),c&2){let a=o.$implicit,i=P();r(2),g(a.categoryName),r(2),g(a.name),r(2),x("$",i._genericService.convertToCurrencyFormat(a.amount).data,""),r(2),g(S(9,6,a.date,"dd/MM/yyyy hh:mm a")),r(3),g(a.description),r(2),g(S(14,9,a.created,"dd/MM/yyyy hh:mm a"))}}j.setOptions($);var z=class c{constructor(){}_genericService=_(C);_highchartService=_(N);_indexeddbService=_(k);_transactions=[];_categories=[];_results={incomes:[],expenses:[],totalIncomes:"0",totalExpenses:"0",total:"0"};chart=null;ngOnInit(){this._indexeddbService.getAllItems("transactions","created","desc").then(o=>{o.length>0&&(this._transactions=o.map(i=>(console.log(i),{transactionId:i.transactionId,name:i.name,amount:i.amount,date:i.date,description:i.description,categoryId:i.categoryId,categoryName:i.category.name,categoryType:i.category.type,created:i.created})));let a=this.getChartOptions();this.chart=this._highchartService.buildChart("container",a),this.updateResults()},o=>{console.error(o)})}ngAfterViewInit(){}ngOnDestroy(){}updateResults(){let o=this._transactions.filter(l=>l.categoryType===1),a=this._transactions.filter(l=>l.categoryType===2),i=o.reduce((l,p)=>l+p.amount,0),u=a.reduce((l,p)=>l+p.amount,0),m=this._genericService.convertToCurrencyFormat(i);if(!m.confirmation){alert(m.message);return}let s=this._genericService.convertToCurrencyFormat(u);if(!s.confirmation){alert(s.message);return}let h=this._genericService.convertToCurrencyFormat(i-u);if(!h.confirmation){alert(h.message);return}this._results.incomes=o,this._results.expenses=a,this._results.totalIncomes=m.data,this._results.totalExpenses=s.data,this._results.total=h.data}getChartOptions(){let o=[],a=[],i=this._genericService.getMonthsFromYear(2025);console.log(this._transactions);for(let m=0;m<i.length;m++){let s=i[m],h=this._transactions.reduce((v,d)=>v+(d.categoryType===1&&d.date>=s.dateStart&&d.date<=s.dateEnd?d.amount:0),0),l=this._transactions.reduce((v,d)=>v+(d.categoryType===2&&d.date>=s.dateStart&&d.date<=s.dateEnd?d.amount:0),0),p=this._genericService.convertToNumberDecimal(h);if(!p.confirmation)continue;let O=this._genericService.convertToNumberDecimal(l);O.confirmation&&(o.push({name:s.name,y:p.data}),a.push({name:s.name,y:O.data}))}let u=[{name:"Ingresos",data:o,color:"#00C853"},{name:"Gastos",data:a,color:"#FF0000"}];return{chart:{type:"column"},title:{text:"Rendimiento del a\xF1o"},xAxis:{categories:i.map(m=>m.name),crosshair:!0,accessibility:{description:"Countries"}},yAxis:{min:0,title:{text:"A\xD1O 2025"}},plotOptions:{column:{pointPadding:.2,borderWidth:0}},tooltip:{valuePrefix:"$"},series:u}}static \u0275fac=function(a){return new(a||c)};static \u0275cmp=T({type:c,selectors:[["app-home"]],features:[D([y,H,C])],decls:39,vars:4,consts:[["caption",""],["header",""],["body",""],[1,"card"],[1,"title"],[1,"balance"],[1,"comment"],["id","container"],[3,"_values"]],template:function(a,i){a&1&&(e(0,"section")(1,"div",3)(2,"span",4),n(3,"Balance total"),t(),e(4,"h3",5),n(5),t(),e(6,"span",6),n(7,"+20.1% del mes pasado"),t()(),e(8,"div",3)(9,"span",4),n(10,"Ingresos del Mes"),t(),e(11,"h3",5),n(12),t(),e(13,"span",6),n(14,"+8.2% del mes pasado"),t()(),e(15,"div",3)(16,"span",4),n(17,"Gastos del Mes"),t(),e(18,"h3",5),n(19),t(),e(20,"span",6),n(21,"-4.5% del mes pasado"),t()(),e(22,"div",3)(23,"span",4),n(24,"Rendimiento"),t(),e(25,"h3",5),n(26,"+18.2%"),t(),e(27,"span",6),n(28,"+4.1% del mes pasado"),t()(),e(29,"div",3),b(30,"div",7),t(),e(31,"div",3)(32,"partial-table",8),I(33,w,2,0,"ng-template",null,0,f)(35,U,13,0,"ng-template",null,1,f)(37,V,15,12,"ng-template",null,2,f),t()()()),a&2&&(r(5),x("$",i._results.total,""),r(7),x("$",i._results.totalIncomes,""),r(7),x("$",i._results.totalExpenses,""),r(13),M("_values",i._transactions))},dependencies:[F,y,R,A],styles:["section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:20px}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px;gap:5px;border-radius:10px;background-color:var(--color-black);border:1px solid var(--color-black-border)}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:is(:nth-child(5),:nth-child(6)){grid-column:span 2}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.6rem}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.2rem}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   span.title[_ngcontent-%COMP%]{font-size:1.3rem}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   span.comment[_ngcontent-%COMP%]{font-size:.8rem;color:var(--color-black-text)}"]})};export{z as HomeComponent};
