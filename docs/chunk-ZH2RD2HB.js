import{a as le,b as ce}from"./chunk-CGRJKAKS.js";import{a as A,b as H,c as O,d as J,e as K,f as Q,g as X,h as Y,i as Z,j as ee,k as te,l as ne,m as ie,n as oe,o as ae,p as re}from"./chunk-3W7ZN6ZC.js";import{$a as M,Ea as W,Ja as x,Mb as I,Nb as B,Ob as $,P as j,Qa as f,Ta as P,Ua as w,Ub as N,V as v,Va as D,Vb as V,Wa as E,Wb as T,Xa as c,Xb as U,Ya as l,Za as h,ab as u,ba as m,bb as d,ca as g,e as C,gb as s,hb as p,ib as b,jb as q,lb as k,mb as R,nb as L,ob as z,qb as F,rb as G,sb as y,va as r}from"./chunk-XT66FLIC.js";var S=class o{constructor(){}_indexeddbService=v(U);_genericService=v(T);_fb=v(oe);loadTable(n,e){return C(this,null,function*(){var i=new V;try{yield this._indexeddbService.getAllItems("categories","created","desc").then(t=>{if(t.total>0){let a=n.search.trim().toLowerCase();e=t.items.filter(_=>_.name.toLowerCase().includes(a)).map(_=>({categoryId:_.categoryId,name:_.name,type:_.type,created:_.created,isDefault:_.isDefault})),n.total=e.length}i.data={partialTableOptions:n,categories:e},i.confirmation=!0,i.message="Tabla cargada correctamente"},t=>{console.error(t)})}catch(t){console.error(t),i.message=t.message,i.exception=t.toString()}return i})}modalOpen(n,e,i=null){var t=new V;try{i!==null?t.data=this._fb.group({opc:["Edit"],opcLabel:[n.modalCreate.opc.edit],categoryId:[i.categoryId,[O.required]],name:[i.name,[O.required,O.maxLength(20)]],type:[i.type,[O.required]]}):t.data=this._fb.group({opc:["Create"],opcLabel:[n.modalCreate.opc.create],name:["",[O.required,O.maxLength(20)]],type:[1,[O.required]]}),t.confirmation=!0,t.message="Modal abierto correctamente"}catch(a){console.error(a),t.message=a.message,t.exception=a.toString()}return t}createOrUpdate(n){return C(this,null,function*(){var e=new N;try{let i=n.value,t=this._genericService.parseNumber(i.type);if(!t.confirmation)return e.message=t.message,e.exception=t.exception,e;if(i.opc==="Edit")yield this._indexeddbService.getItem("categories",i.categoryId).then(a=>C(this,null,function*(){a.name=i.name,a.type=t.data,yield this._indexeddbService.updateItem("categories",a.categoryId,a).then(_=>{e.confirmation=!0,e.message="Categoria actualizada correctamente"},_=>{console.error(_),e.message=_.message,e.exception=_.toString()})}),a=>{console.error(a),e.message=a.message,e.exception=a.toString()});else{let a={categoryId:this._genericService.generateGuid(),name:i.name,type:t.data,created:this._genericService.getDateTimeNow(),isDefault:!1};yield this._indexeddbService.addItem("categories",a).then(_=>{e.confirmation=!0,e.message="Categoria creada correctamente"},_=>{console.error(_),e.message=_.message,e.exception=_.toString()})}}catch(i){console.error(i),e.message=i.message,e.exception=i.toString()}return e})}delete(n){return C(this,null,function*(){var e=new N;try{yield this._indexeddbService.deleteItem("categories",n).then(i=>{this._indexeddbService.getAllItems("transactions","created","desc").then(t=>{t.total>0&&t.items.filter(a=>a.categoryId===n).forEach(a=>C(this,null,function*(){yield this._indexeddbService.deleteItem("transactions",a.transactionId)}))},t=>{console.error(t),e.message=t.message,e.exception=t.toString()}),e.confirmation=!0,e.message="Categoria eliminada correctamente"},i=>{console.error(i),e.message=i.message,e.exception=i.toString()})}catch(i){console.error(i),e.message=i.message,e.exception=i.toString()}return e})}getDictionary(n){return C(this,null,function*(){var e=new V;try{e=yield this._genericService.getDictionary(`configuration/${n.language}.json`)}catch(i){console.error(i),e.message=i.message,e.exception=i.toString()}return e})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=j({token:o,factory:o.\u0275fac,providedIn:"root"})};function pe(o,n){if(o&1&&(c(0,"option",10),s(1),l()),o&2){let e=n.$implicit;f("value",e.value),r(),p(e.label)}}function _e(o,n){if(o&1&&(c(0,"option",10),s(1),l()),o&2){let e=n.$implicit;f("value",e.value),r(),p(e.label)}}function me(o,n){if(o&1){let e=M();c(0,"div",15)(1,"h2"),s(2),l(),c(3,"button",16),u("click",function(){m(e);let t=d(2);return g(t.onOpenModal())}),s(4),l(),c(5,"input",17),u("input",function(t){m(e);let a=d(2);return g(a.onSearch(t))}),l()()}if(o&2){let e=d(2);r(2),p(e._dictionary.cardTable.title),r(2),p(e._dictionary.cardTable.button),r(),f("placeholder",e._dictionary.cardTable.search)}}function ge(o,n){if(o&1&&(c(0,"tr")(1,"th"),s(2),l(),c(3,"th"),s(4),l(),c(5,"th"),s(6),l(),c(7,"th"),s(8,"OPC"),l()()),o&2){let e=d(2);r(2),p(e._dictionary.cardTable.header.type),r(2),p(e._dictionary.cardTable.header.name),r(2),p(e._dictionary.cardTable.header.created)}}function Ce(o,n){if(o&1){let e=M();c(0,"div",18)(1,"button",19),u("click",function(){m(e);let t=d().$implicit,a=d(2);return g(a.onOpenModal(t))}),h(2,"i",20),l(),c(3,"button",21),u("click",function(){m(e);let t=d().$implicit,a=d(2);return g(a.onModalOpenDelete(t))}),h(4,"i",22),l()()}if(o&2){let e=d(3);r(),f("title",e._dictionary.cardTable.opc.edit),r(2),f("title",e._dictionary.cardTable.opc.delete)}}function ue(o,n){if(o&1&&(c(0,"tr")(1,"td"),s(2),l(),c(3,"td"),s(4),l(),c(5,"td"),s(6),F(7,"date"),l(),c(8,"td"),x(9,Ce,5,2,"div",18),l()()),o&2){let e=n.$implicit;r(2),p(e.type===1?"Ingreso":"Gasto"),r(2),p(e.name),r(2),p(G(7,4,e.created,"dd/MM/yyyy hh:mm a")),r(3),P(e.isDefault?-1:9)}}function fe(o,n){if(o&1){let e=M();c(0,"strong"),s(1,"OPC:"),l(),c(2,"div",18)(3,"button",19),u("click",function(){m(e);let t=d().$implicit,a=d(2);return g(a.onOpenModal(t))}),h(4,"i",20),l(),c(5,"button",21),u("click",function(){m(e);let t=d().$implicit,a=d(2);return g(a.onModalOpenDelete(t))}),h(6,"i",22),l()()}if(o&2){let e=d(3);r(3),f("title",e._dictionary.cardTable.opc.edit),r(2),f("title",e._dictionary.cardTable.opc.delete)}}function ye(o,n){if(o&1&&(c(0,"ul")(1,"li")(2,"strong"),s(3),l(),s(4),l(),c(5,"li")(6,"strong"),s(7),l(),s(8),l(),c(9,"li")(10,"strong"),s(11),l(),s(12),F(13,"date"),l(),c(14,"li"),x(15,fe,7,2),l()()),o&2){let e=n.$implicit,i=d(2);r(3),b("",i._dictionary.cardTable.header.type,":"),r(),b(" ",e.type===1?"Ingreso":"Gasto",""),r(3),b("",i._dictionary.cardTable.header.name,":"),r(),b(" ",e.name,""),r(3),b("",i._dictionary.cardTable.header.created,":"),r(),b(" ",G(13,7,e.created,"dd/MM/yyyy hh:mm a"),""),r(3),P(e.isDefault?-1:15)}}function xe(o,n){if(o&1&&(c(0,"h2"),s(1),l()),o&2){let e,i=d(3);r(),q("",(e=i._form.get("opcLabel"))==null?null:e.value," ",i._dictionary.modalCreate.title,"")}}function be(o,n){if(o&1&&(c(0,"option",10),s(1),l()),o&2){let e=n.$implicit;f("value",e.value),r(),p(e.label)}}function Oe(o,n){if(o&1&&(c(0,"div",6)(1,"div",7)(2,"label",25),s(3),l(),h(4,"input",26),l(),c(5,"div",7)(6,"label",27),s(7),l(),c(8,"select",28),D(9,be,2,2,"option",10,w),l()()()),o&2){let e=d(3);r(3),p(e._dictionary.modalCreate.name),r(4),p(e._dictionary.modalCreate.type.label),r(2),E(e._categoryTypes)}}function ve(o,n){if(o&1&&(c(0,"div",29)(1,"button",30),s(2),l()()),o&2){let e,i=d(3);r(),f("disabled",i._form.invalid),r(),p((e=i._form.get("opcLabel"))==null?null:e.value)}}function he(o,n){if(o&1){let e=M();c(0,"form",23),u("ngSubmit",function(){m(e);let t=d(2);return g(t.onSubmitForm(t._form))}),c(1,"partial-modal",24),u("eventCloseModal",function(){m(e);let t=d(2);return g(t.onCloseModal())}),x(2,xe,2,2,"ng-template",null,1,y)(4,Oe,11,2,"ng-template",null,2,y)(6,ve,3,2,"ng-template",null,4,y),l()()}if(o&2){let e=d(2);f("formGroup",e._form)}}function Me(o,n){if(o&1&&(c(0,"h2"),s(1),l()),o&2){let e=d(3);r(),p(e._dictionary.modalDelete.title)}}function Pe(o,n){if(o&1&&(c(0,"h4"),s(1),c(2,"b"),s(3),l(),s(4,"?"),l()),o&2){let e=d(3);r(),b("",e._dictionary.modalDelete.body," "),r(2),p(e._selectedCategory.name)}}function Te(o,n){if(o&1){let e=M();c(0,"partial-modalconfirmation",31),u("eventOnSuccess",function(){m(e);let t=d(2);return g(t.onDelete(t._selectedCategory))})("eventOnCancel",function(){m(e);let t=d(2);return t._modals.deleteCategory=!1,g(t._selectedCategory=null)}),x(1,Me,2,1,"ng-template",null,1,y)(3,Pe,5,2,"ng-template",null,2,y),l()}}function Se(o,n){if(o&1){let e=M();c(0,"section")(1,"div",5)(2,"h2"),s(3),l(),c(4,"div",6)(5,"div",7)(6,"label",8),s(7),l(),c(8,"select",9),L("ngModelChange",function(t){m(e);let a=d();return R(a._selectedLanguage,t)||(a._selectedLanguage=t),g(t)}),u("change",function(t){m(e);let a=d();return g(a.onChangeLanguage(t))}),D(9,pe,2,2,"option",10,w),l()(),c(11,"div",7)(12,"label",11),s(13),l(),c(14,"select",12),L("ngModelChange",function(t){m(e);let a=d();return R(a._selectedCurrency,t)||(a._selectedCurrency=t),g(t)}),u("change",function(t){m(e);let a=d();return g(a.onChangeCurrency(t))}),D(15,_e,2,2,"option",10,w),l()()(),h(17,"hr"),c(18,"partial-table",13),u("eventOnLoad",function(t){m(e);let a=d();return g(a.loadPartialTable(t))})("eventOnChange",function(t){m(e);let a=d();return g(a.changePartialTable(t))}),x(19,me,6,3,"ng-template",null,0,y)(21,ge,9,3,"ng-template",null,1,y)(23,ue,10,7,"ng-template",null,2,y)(25,ye,16,10,"ng-template",null,3,y),l()()(),x(27,he,8,1,"form",14)(28,Te,5,0,"partial-modalconfirmation")}if(o&2){let e=d();r(3),p(e._dictionary.cardTitle),r(4),p(e._dictionary.cardCombo.language.label),r(),k("ngModel",e._selectedLanguage),r(),E(e._languages),r(4),p(e._dictionary.cardCombo.currency),r(),k("ngModel",e._selectedCurrency),r(),E(e._currencies),r(3),f("_values",e._categories)("_options",e._partialTableOptions),r(9),P(e._modals.category&&e._form!==null?27:-1),r(),P(e._modals.deleteCategory&&e._selectedCategory!==null?28:-1)}}var de=class o{constructor(){}_genericService=v(T);_configurationService=v(S);_localStorage=this._genericService.getDataLocalStorage();_dictionary=null;_categories=[];_selectedCategory=null;_selectedCurrency="$";_currencies=[{value:"$",label:"$ USD"},{value:"\u20AC",label:"\u20AC EUR"},{value:"S/.",label:"S/. PEN"}];_selectedLanguage="es";_languages=[];_partialTableOptions={search:"",skip:0,take:5,total:0};_form=null;_modals={category:!1,deleteCategory:!1};_categoryTypes=[];ngOnInit(){return C(this,null,function*(){yield this.loadDictionary(),this._selectedCurrency=this._localStorage.currency,this._selectedLanguage=this._localStorage.language,yield this.loadTable()})}ngAfterViewInit(){}ngAfterContentInit(){}ngOnDestroy(){}loadDictionary(){return C(this,null,function*(){let n=yield this._configurationService.getDictionary(this._localStorage);n.confirmation&&(this._dictionary=n.data,this._languages=[{value:"en",label:this._dictionary.cardCombo.language.english},{value:"es",label:this._dictionary.cardCombo.language.spanish}],this._categoryTypes=[{value:1,label:this._dictionary.modalCreate.type.income},{value:2,label:this._dictionary.modalCreate.type.expense}])})}loadTable(){return C(this,null,function*(){let n=yield this._configurationService.loadTable(this._partialTableOptions,this._categories);n.confirmation&&(this._partialTableOptions=n.data.partialTableOptions,this._categories=n.data.categories)})}onOpenModal(n=null){if(this._dictionary!==null){var e=this._configurationService.modalOpen(this._dictionary,this._categories,n);if(!e.confirmation){alert(e.message);return}this._form=e.data,this._selectedCategory=n,this._modals.category=!0}}onCloseModal(){this._modals.category=!1}onSubmitForm(n){return C(this,null,function*(){var e=yield this._configurationService.createOrUpdate(n);if(!e.confirmation){alert(e.message);return}this._modals.category=!1,this.loadTable()})}onModalOpenDelete(n){this._selectedCategory=n,this._modals.deleteCategory=!0}onDelete(n){return C(this,null,function*(){let e=yield this._configurationService.delete(n.categoryId);if(!e.confirmation){alert(e.message);return}this._modals.deleteCategory=!1,this.loadTable()})}loadPartialTable(n){this._partialTableOptions=n,this.loadTable()}changePartialTable(n){this._partialTableOptions=n,this.loadTable()}onSearch(n){this._partialTableOptions.search=n.target.value,this.loadTable()}onChangeCurrency(n){this._genericService.setLocalStorage("currency",n.target.value)}onChangeLanguage(n){this._genericService.setLocalStorage("language",n.target.value),window.location.reload()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=W({type:o,selectors:[["app-configuration"]],features:[z([S,T,I,B])],decls:1,vars:1,consts:[["caption",""],["header",""],["body",""],["bodyMobile",""],["footer",""],[1,"card"],[1,"form"],[1,"form-group"],["for","language"],["id","language","name","language","required","",3,"ngModelChange","change","ngModel"],[3,"value"],["for","currency"],["id","currency","name","currency","required","",3,"ngModelChange","change","ngModel"],[3,"eventOnLoad","eventOnChange","_values","_options"],[3,"formGroup"],[1,"caption"],["type","button",1,"btn","success",3,"click"],["type","text",3,"input","placeholder"],[1,"operations"],["type","button",1,"btn","primary",3,"click","title"],[1,"pi","pi-pen-to-square"],["type","button",1,"btn","danger",3,"click","title"],[1,"pi","pi-trash"],[3,"ngSubmit","formGroup"],[3,"eventCloseModal"],["for","name"],["type","text","formControlName","name","id","name","name","name","autocomplete","off","required",""],["for","type"],["formControlName","type","id","type","name","type","required",""],[1,"footer"],["type","submit",1,"btn","success",3,"disabled"],[3,"eventOnSuccess","eventOnCancel"]],template:function(e,i){e&1&&x(0,Se,29,9),e&2&&P(i._dictionary!==null?0:-1)},dependencies:[$,I,ae,X,te,ne,H,ee,J,K,ie,Q,re,Y,Z,le,A,ce],styles:["partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{width:100%;display:grid;gap:10px;view-transition-name:partial-table}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{overflow:auto;max-height:400px}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   table.partial-table[_ngcontent-%COMP%]{background-color:var(--color-black);border:1px solid var(--color-black-border);min-width:100%;border-spacing:0;border-collapse:collapse;position:relative}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   table.partial-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:var(--color-black);position:sticky;top:-1px}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   table.partial-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px;text-align:left;word-break:break-word;overflow-wrap:break-word}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   table.partial-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--color-black-weight)}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   table.partial-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:left;word-break:break-word;overflow-wrap:break-word}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .partial-table-mobile[_ngcontent-%COMP%]{display:none;flex-direction:column}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .partial-table-mobile[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column;gap:10px}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .partial-table-mobile[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--color-black-weight)}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .partial-table-mobile[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;gap:10px}section[_ngcontent-%COMP%]{container-type:inline-size;display:flex;flex-direction:column;gap:20px}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px;gap:20px;border-radius:10px;background-color:var(--color-black);border:1px solid var(--color-black-border)}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   partial-table[_ngcontent-%COMP%]{container-type:inline-size}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   partial-table[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr repeat(2,auto);align-items:center;gap:10px}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   partial-table[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.2rem}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   partial-table[_ngcontent-%COMP%]   span.title[_ngcontent-%COMP%]{font-size:1.3rem}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   partial-table[_ngcontent-%COMP%]   span.comment[_ngcontent-%COMP%]{font-size:.8rem;color:var(--color-black-text)}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   partial-table[_ngcontent-%COMP%]   .operations[_ngcontent-%COMP%]{display:flex;gap:5px;align-items:center;justify-content:center;font-size:1px}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   partial-table[_ngcontent-%COMP%]   .operations[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;font-size:.8rem!important}@container (width <= 600px){section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   partial-table[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{grid-template-columns:1fr}}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.6rem}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1.1rem}@container (width <= 600px){section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{padding:10px!important}}.form[_ngcontent-%COMP%], .form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1.1rem}.footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]})};export{de as ConfigurationComponent};
