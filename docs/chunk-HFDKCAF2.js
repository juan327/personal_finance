import{b as B,c as _,d as $,e as j,f as W,g as U,h as H,i as J,j as K,k as Q,l as X,m as Y,n as Z,o as ee,p as te,q as ne,r as ie}from"./chunk-F4QZEJFO.js";import{a as A}from"./chunk-7QTDYJDQ.js";import{$a as y,Ea as I,Ja as b,Mb as h,Nb as q,Ob as G,Qa as x,Ta as O,Tb as T,Ua as E,Ub as z,V as v,Va as S,Wa as w,Xa as a,Ya as r,Za as M,ab as g,ba as d,bb as m,ca as s,e as P,gb as l,hb as C,ib as V,lb as k,mb as D,nb as F,ob as N,qb as L,rb as R,sb as u,va as c}from"./chunk-XMB6CGJJ.js";function ae(i,t){if(i&1&&(a(0,"option",9),l(1),r()),i&2){let e=t.$implicit;x("value",e.value),c(),C(e.label)}}function re(i,t){if(i&1){let e=y();a(0,"div",12)(1,"h2"),l(2,"Categorias"),r(),a(3,"button",13),g("click",function(){d(e);let o=m();return s(o.openModal())}),l(4,"Agregar categoria"),r(),a(5,"input",14),g("input",function(o){d(e);let p=m();return s(p.search(o))}),r()()}}function le(i,t){i&1&&(a(0,"tr")(1,"th"),l(2,"Tipo"),r(),a(3,"th"),l(4,"Nombre"),r(),a(5,"th"),l(6,"Creaci\xF3n"),r(),a(7,"th"),l(8,"OPC"),r()())}function ce(i,t){if(i&1){let e=y();a(0,"div",15)(1,"button",16),g("click",function(){d(e);let o=m().$implicit,p=m();return s(p.openModal(o))}),M(2,"i",17),r(),a(3,"button",18),g("click",function(){d(e);let o=m().$implicit,p=m();return s(p.modalOpenDelete(o))}),M(4,"i",19),r()()}}function me(i,t){if(i&1&&(a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),L(7,"date"),r(),a(8,"td"),b(9,ce,5,0,"div",15),r()()),i&2){let e=t.$implicit;c(2),C(e.type===1?"Ingreso":"Gasto"),c(2),C(e.name),c(2),C(R(7,4,e.created,"dd/MM/yyyy hh:mm a")),c(3),O(e.isDefault?-1:9)}}function pe(i,t){if(i&1&&(a(0,"h2"),l(1),r()),i&2){let e,n=m(2);c(),V("",(e=n._form.get("opcLabel"))==null?null:e.value," categoria")}}function de(i,t){if(i&1&&(a(0,"option",9),l(1),r()),i&2){let e=t.$implicit;x("value",e.value),c(),C(e.label)}}function se(i,t){if(i&1&&(a(0,"div",5)(1,"div",6)(2,"label",22),l(3,"Nombre"),r(),M(4,"input",23),r(),a(5,"div",6)(6,"label",24),l(7,"Tipo"),r(),a(8,"select",25),S(9,de,2,2,"option",9,E),r()()()),i&2){let e=m(2);c(9),w(e._types)}}function _e(i,t){if(i&1&&(a(0,"div",26)(1,"button",27),l(2),r()()),i&2){let e,n=m(2);c(),x("disabled",n._form.invalid),c(),C((e=n._form.get("opcLabel"))==null?null:e.value)}}function ge(i,t){if(i&1){let e=y();a(0,"form",20),g("ngSubmit",function(){d(e);let o=m();return s(o.submitForm(o._form))}),a(1,"partial-modal",21),g("eventCloseModal",function(){d(e);let o=m();return s(o.closeModal())}),b(2,pe,2,1,"ng-template",null,1,u)(4,se,11,0,"ng-template",null,2,u)(6,_e,3,2,"ng-template",null,3,u),r()()}if(i&2){let e=m();x("formGroup",e._form)}}function ue(i,t){i&1&&(a(0,"h2"),l(1,"Eliminar ingreso"),r())}function Ce(i,t){if(i&1&&(a(0,"h4"),l(1,"\xBFEst\xE1 seguro de que desea eliminar el ingreso "),a(2,"b"),l(3),r(),l(4,"?"),r()),i&2){let e=m(2);c(3),C(e._selectedCategory.name)}}function fe(i,t){if(i&1){let e=y();a(0,"partial-modalconfirmation",28),g("eventOnSuccess",function(){d(e);let o=m();return s(o.onDelete(o._selectedCategory))})("eventOnCancel",function(){d(e);let o=m();return o._modals.deleteCategory=!1,s(o._selectedCategory=null)}),b(1,ue,2,0,"ng-template",null,1,u)(3,Ce,5,1,"ng-template",null,2,u),r()}}var oe=class i{constructor(){}_genericService=v(T);_indexeddbService=v(z);_fb=v(Z);_categories=[];_selectedCategory=null;_selectedCurrency="$";_currencies=[{value:"$",label:"$ USD"},{value:"\u20AC",label:"\u20AC EUR"},{value:"S/.",label:"S/. PEN"}];_options={search:"",skip:0,take:5,total:0};_form=null;_modals={category:!1,deleteCategory:!1};_types=[{value:1,label:"Ingreso"},{value:2,label:"Gasto"}];ngOnInit(){this.loadTable()}ngAfterViewInit(){}ngAfterContentInit(){}ngOnDestroy(){}loadTable(){this._indexeddbService.getAllItems("categories","created","desc").then(t=>{if(t.total>0){let e=this._options.search.trim().toLowerCase();this._categories=t.items.filter(n=>n.name.toLowerCase().includes(e)),this._options.total=this._categories.length}},t=>{console.error(t)})}openModal(t=null){t!==null?(this._selectedCategory=t,this._form=this._fb.group({opc:["Edit"],opcLabel:["Editar"],categoryId:[t.categoryId,[_.required]],name:[t.name,[_.required,_.minLength(3),_.maxLength(20)]],type:[t.type,[_.required]]})):this._form=this._fb.group({opc:["Create"],opcLabel:["Crear"],name:["",[_.required,_.minLength(3),_.maxLength(20)]],type:[1,[_.required]]}),this._modals.category=!0}closeModal(){this._modals.category=!1}submitForm(t){return P(this,null,function*(){let e=t.value,n=this._genericService.parseNumber(e.type);if(!n.confirmation){alert(n.message);return}if(e.opc==="Edit")this._indexeddbService.getItem("categories",e.categoryId).then(o=>{o.name=e.name,o.type=n.data,this._indexeddbService.updateItem("categories",o.categoryId,o).then(p=>{this._modals.category=!1,this.loadTable()},p=>{console.error(p)})},o=>{console.error(o)});else{let o={categoryId:this._genericService.generateGuid(),name:e.name,type:n.data,created:new Date,isDefault:!1};this._indexeddbService.addItem("categories",o).then(p=>{this._modals.category=!1,this.loadTable()},p=>{console.error(p)})}})}modalOpenDelete(t){this._selectedCategory=t,this._modals.deleteCategory=!0}onDelete(t){this._indexeddbService.deleteItem("categories",t.categoryId).then(e=>{this._indexeddbService.getAllItems("transactions","created","desc").then(n=>{n.total>0&&n.items.filter(o=>o.categoryId===t.categoryId).forEach(o=>P(this,null,function*(){yield this._indexeddbService.deleteItem("transactions",o.transactionId)}))},n=>{console.error(n)}),this._modals.deleteCategory=!1,this.loadTable()},e=>{console.error(e)})}loadPartialTable(t){this._options=t,this.loadTable()}changePartialTable(t){this._options=t,this.loadTable()}search(t){this._options.search=t.target.value,this.loadTable()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=I({type:i,selectors:[["app-configuration"]],features:[N([T,h,q])],decls:20,vars:5,consts:[["caption",""],["header",""],["body",""],["footer",""],[1,"card"],[1,"form"],[1,"form-group"],["for","currency"],["id","currency","name","currency","required","",3,"ngModelChange","ngModel"],[3,"value"],[3,"eventOnLoad","eventOnChange","_values","_options"],[3,"formGroup"],[1,"caption"],["type","button",1,"btn","success",3,"click"],["type","text","placeholder","Busqueda rapida...",3,"input"],[1,"operations"],["type","button","title","Editar",1,"btn","primary",3,"click"],[1,"pi","pi-pen-to-square"],["type","button","title","Eliminar",1,"btn","danger",3,"click"],[1,"pi","pi-trash"],[3,"ngSubmit","formGroup"],[3,"eventCloseModal"],["for","name"],["type","text","formControlName","name","id","name","name","name","autocomplete","off","required",""],["for","type"],["formControlName","type","id","type","name","type","required",""],[1,"footer"],["type","submit",1,"btn","success",3,"disabled"],[3,"eventOnSuccess","eventOnCancel"]],template:function(e,n){if(e&1){let o=y();a(0,"section")(1,"div",4)(2,"h2"),l(3,"Configuraci\xF3n"),r(),a(4,"div",5)(5,"div",6)(6,"label",7),l(7,"Divisa"),r(),a(8,"select",8),F("ngModelChange",function(f){return d(o),D(n._selectedCurrency,f)||(n._selectedCurrency=f),s(f)}),S(9,ae,2,2,"option",9,E),r()()(),a(11,"partial-table",10),g("eventOnLoad",function(f){return d(o),s(n.loadPartialTable(f))})("eventOnChange",function(f){return d(o),s(n.changePartialTable(f))}),b(12,re,6,0,"ng-template",null,0,u)(14,le,9,0,"ng-template",null,1,u)(16,me,10,7,"ng-template",null,2,u),r()()(),b(18,ge,8,1,"form",11)(19,fe,5,0,"partial-modalconfirmation")}e&2&&(c(8),k("ngModel",n._selectedCurrency),c(),w(n._currencies),c(2),x("_values",n._categories)("_options",n._options),c(7),O(n._modals.category&&n._form!==null?18:-1),c(),O(n._modals.deleteCategory&&n._selectedCategory!==null?19:-1))},dependencies:[G,h,ee,U,Q,X,B,K,$,j,Y,W,te,H,J,ne,A,ie],styles:["partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{width:100%;display:grid;gap:10px}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{overflow:auto;max-height:400px}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{background-color:var(--color-black);border:1px solid var(--color-black-border);min-width:100%;border-spacing:0;border-collapse:collapse;position:relative}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:var(--color-black);position:sticky;top:-1px}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px;text-align:left;word-break:break-word;overflow-wrap:break-word}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--color-black-weight)}partial-table[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:left;word-break:break-word;overflow-wrap:break-word}section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}section[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr auto 1fr;align-items:center;gap:10px}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px;gap:20px;border-radius:10px;background-color:var(--color-black);border:1px solid var(--color-black-border)}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.6rem}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.2rem}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   span.title[_ngcontent-%COMP%]{font-size:1.3rem}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   span.comment[_ngcontent-%COMP%]{font-size:.8rem;color:var(--color-black-text)}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .operations[_ngcontent-%COMP%]{display:flex;gap:5px;align-items:center;justify-content:center;font-size:1px}section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .operations[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;font-size:.8rem!important}.form[_ngcontent-%COMP%], .form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1.1rem}.footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]})};export{oe as ConfigurationComponent};
